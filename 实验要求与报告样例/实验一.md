# Pima Indians Diabetes回归问题实验报告

- **姓名**：
- **学号**：
- **学院**：

---

## 一、基础EDA和统计分析

### 1.1 数据集基本信息
- **数据集名称**：Pima Indians Diabetes Database
- **样本数量**：768条
- **特征数量**：8个（+ 1个目标变量）

### 1.2 特征字段说明
```
diabetes_data.info(verbose=True)
```
  得到结果如下：
```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 768 entries, 0 to 767
Data columns (total 9 columns):
Pregnancies                 768 non-null int64
Glucose                     768 non-null int64
BloodPressure               768 non-null int64
SkinThickness               768 non-null int64
Insulin                     768 non-null int64
BMI                         768 non-null float64
DiabetesPedigreeFunction    768 non-null float64
Age                         768 non-null int64
Outcome                     768 non-null int64
dtypes: float64(2), int64(7)
memory usage: 54.1 KB
```
### 1.3数据统计分析
```
diabetes_data.describe().T
```
统计结果如下：
![[Pasted image 20251118161906.png]]
---

## 二、特征工程 

### 2.1 数据清洗

#### 2.1.1 异常值处理

**问题识别**：
- Glucose（血糖）、BloodPressure（血压）、SkinThickness（皮褶厚度）、Insulin（胰岛素）、BMI（体重指数）中存在值为0的记录
- 医学上这些特征不应为0，因此将其视为缺失值

**处理方法**：
```python
diabetes_data_copy = diabetes_data.copy(deep = True)
diabetes_data_copy[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = diabetes_data_copy[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].replace(0,np.NaN)

## showing the count of Nans
print(diabetes_data_copy.isnull().sum())
```

**处理结果**：
```
Pregnancies                   0
Glucose                       5
BloodPressure                35
SkinThickness               227
Insulin                     374
BMI                          11
DiabetesPedigreeFunction      0
Age                           0
Outcome                       0
dtype: int64
```

#### 2.1.2 缺失值处理

**选择的方法**：**均值填充法（Mean Imputation）** **和中位数填充法（Median Imputation）**

**实现代码**：
```python
diabetes_data_copy['Glucose'].fillna(diabetes_data_copy['Glucose'].mean(), inplace = True)
diabetes_data_copy['BloodPressure'].fillna(diabetes_data_copy['BloodPressure'].mean(), inplace = True)
diabetes_data_copy['SkinThickness'].fillna(diabetes_data_copy['SkinThickness'].median(), inplace = True)
diabetes_data_copy['Insulin'].fillna(diabetes_data_copy['Insulin'].median(), inplace = True)
diabetes_data_copy['BMI'].fillna(diabetes_data_copy['BMI'].median(), inplace = True)
```

**处理前后柱状图对比**
处理前：
![[Pasted image 20251118163003.png]]
处理后：
![[Pasted image 20251118163105.png]]

### 2.2 特征标准化

**方法选择**：**StandardScaler（标准化）**

**数学公式**：
$$x' = \frac{x - \mu}{\sigma}$$

其中 $\mu$ 为均值，$\sigma$ 为标准差

**实现代码**：
```python
from sklearn.preprocessing import StandardScaler
sc_X = StandardScaler()
X =  pd.DataFrame(sc_X.fit_transform(diabetes_data_copy.drop(["Outcome"],axis = 1),),
        columns=['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin',
       'BMI', 'DiabetesPedigreeFunction', 'Age'])
```

**标准化后用X.head()查看数据变化**：

![[Pasted image 20251118164415.png]]

---
## 三、模型建立与训练

### 3.1 数据集划分

**划分方案**：由于我学号尾数是2，学号为偶数：train_size = 0.75, 0.8, 0.85

**划分结果**：

| train_size | 训练集样本数 | 测试集样本数 |
| ---------- | ------ | ------ |
| 0.75       | 576    | 192    |
| 0.8        | 614    | 154    |
| 0.85       | 652    | 116    |

### 3.2 逻辑回归模型

**模型原理**：逻辑回归是一种线性分类模型，使用Sigmoid函数将线性模型的输出映射到[0,1]区间，表示样本属于某一类的概率。

**模型公式**：
$$P(y=1|x) = \frac{1}{1 + e^{-(w \cdot x + b)}}$$

**实现代码**：
```python
from sklearn.linear_model import LogisticRegression

lr_model = LogisticRegression(random_state=42, max_iter=1000)
lr_model.fit(X_train, y_train)
```

### 3.3 模型性能评估

![[Pasted image 20251118171506.png]]
#### 3.3.1 最优模型的详细评估

选择最优train_size: **0.8**

**分类报告**：

```
              precision    recall  f1-score   support

           0       0.80      0.83      0.81        99
           1       0.67      0.62      0.64        55

    accuracy                           0.75       154
   macro avg       0.73      0.72      0.73       154
weighted avg       0.75      0.75      0.75       154
```
---
## 四、结果分析
#### 4.1各特征与Outcome的相关系数

![[Pasted image 20251118173307.png]]


#### 4.2 逻辑回归模型系数

模型系数（特征重要性）：

```python
feature_importance = pd.DataFrame({
    'Feature': X.columns,
    'Coefficient': final_model.coef_[0],
}).sort_values('Coefficient', ascending=False)
```

```
                    Feature  Coefficient  Abs_Coefficient
1                   Glucose     1.095331         1.095331
5                       BMI     0.673791         0.673791
7                       Age     0.403497         0.403497
0               Pregnancies     0.228737         0.228737
6  DiabetesPedigreeFunction     0.196784         0.196784
2             BloodPressure    -0.145340         0.145340
4                   Insulin    -0.094892         0.094892
3             SkinThickness     0.071388         0.071388
```

**系数解读**：
- **正系数**：特征值增大→患糖尿病概率增大
- **负系数**：特征值增大→患糖尿病概率降低
- **绝对值大小**：影响程度大小

### 4.3 特征排序

**按相关系数排序**（从高到低）：

1. Glucose — 相关系数: 0.4929
    
2. BMI — 相关系数: 0.3119
    
3. Age — 相关系数: 0.2384
    
4. Pregnancies — 相关系数: 0.2219
    
5. Skin Thickness — 相关系数: 0.2153
    
6. Insulin — 相关系数: 0.2144
    
7. Diabetes Pedigree Function — 相关系数: 0.1738
    
8. Blood Pressure — 相关系数: 0.1661

**按模型系数排序**（按绝对值从大到小）：

1. Glucose — 系数: 1.095
    
2. BMI — 系数: 0.674
    
3. Age — 系数: 0.403
    
4. Pregnancies — 系数: 0.229
    
5. Diabetes Pedigree Function — 系数: 0.197
    
6. Blood Pressure — 系数: 0.145
    
7. Insulin — 系数: 0.095
    
8. Skin Thickness — 系数: 0.071

### 4.4 特征分析结论

**主要发现**：
- Glucose是糖尿病发病最直接和最强的风险因素。在统计分析和模型预测中，血糖相关系数与模型系数均排名第一，说明血糖水平越高，患糖尿病的风险显著增加。​
    
- BMI与Age同样具有明显的影响力。超重、肥胖和年龄增长都会显著增加糖尿病的患病风险​。​
    
- 其他特征如Skin Thickness、Insulin及Blood Pressure在本次分析中影响相对较小，但综合评估时可作为辅助参考。[](https://www.who.int/zh/news-room/fact-sheets/detail/diabetes)​
    
- 数据和模型排序结果基本一致，进一步确认了Glucose、BMI和Age是糖尿病确诊的核心方向。

---

## 五、可视化结果

### 5.1 逻辑回归散点图

![[Pasted image 20251118175147.png]]
![[Pasted image 20251118175210.png]]
### 5.2 特征值相关性热力图

![[Pasted image 20251118175401.png]]

---
## 五、参考资源

- Kaggle数据集：https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database
- Kaggle相关教程：https://www.kaggle.com/code/baozixuan/step-by-step-diabetes-classification
- 2025本科生《神经网络与深度学习》课程实验（1）



